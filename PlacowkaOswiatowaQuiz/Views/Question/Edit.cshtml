@model QuestionViewModel
@{ViewData["Title"] = "Pytanie - edycja";}

<fieldset class="border p-2">
    <legend class="w-auto">
        <b>Nowe pytanie</b>
    </legend>
    <div id="divAlertArea">
        <partial name="~/Views/UIComponents/_bootstrapAlert.cshtml" />
    </div>
    <div asp-validation-summary="All" class="text-danger container-flex md-2 mb-3">
        <span>Popraw następujące błędy i spróbuj ponownie:</span>
    </div>
    <form method="post" asp-controller="Question" asp-action="Edit">
        <input type="hidden" asp-for="@Model.Id" />
        <div class="container-fluid">
            <div class="row mb-3">
                <label asp-for="@Model.Content" class="col-sm-2 form-label"></label>
                <div class="col-sm-8">
                    <input asp-for="@Model.Content" type="text" class="form-control"
                           placeholder="Wprowadź treść pytania...">
                </div>
            </div>
            <div class="row mb-3">
                <label asp-for="@Model.Description" class="col-sm-2 col-form-label"></label>
                <div class="col-sm-10">
                    <textarea asp-for="@Model.Description" type="text" class="form-control"
                              placeholder="Co robi nauczyciel..." rows="3"></textarea>
                </div>
            </div>
            <div class="row mb-3">
                <label asp-for="@Model.QuestionsSetId" class="col-sm-2 col-form-label"></label>
                <div class="col-sm-10">
                    <select asp-for="@Model.QuestionsSetId" class="form-control" id="questionsSetDropdown"
                            currentQuestionsSetId="@Model?.QuestionsSetId">
                        <option disabled selected>Wybierz zestaw pytań po opisie umiejętności...</option>
                    </select>
                </div>
            </div>
            <div class="d-grid gap-2 col-6 mx-auto">
                <button class="btn btn-success" type="submit">Utwórz</button>
                <a class="btn btn-outline-secondary" type="button" asp-controller="Question"
                   asp-action="Index">Powrót do listy pytań</a>
            </div>
        </div>
    </form>
</fieldset>

<script>$(document).ready(function () {
        var currentQuestionsSetId = $("#questionsSetDropdown").attr('currentQuestionsSetId');
        $.ajax({
            type: "GET",
            url: "/QuestionsSet/GetAllQuestionsSets",
            data: "{}",
            success: function (data) {
                $.each(data, function (i, questionsSet) {
                    if (questionsSet.id != currentQuestionsSetId)
                        $("#questionsSetDropdown").append(
                            "<option value=" + questionsSet.id + ">" +
                            questionsSet.skillDescription + "</option>");
                    else
                        $("#questionsSetDropdown").append(
                            "<option selected value=" + questionsSet.id + ">" +
                            questionsSet.skillDescription + "</option>");
                });
            }
        });
    });</script>

<style>
    legend {
        float: none;
        padding: inherit;
    }

    .validation-summary-valid {
        display: none;
    }
</style>