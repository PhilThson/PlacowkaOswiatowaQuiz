@model AttachmentFileViewModel

<div class="panel-body scroll panel-height">
    <table class="CustomColorTable" border="0">
        <thead>
            <tr>
                <th>@Html.DisplayNameFor(m => m.Id)</th>
                <th>@Html.DisplayNameFor(m => m.Name)</th>
                <th>@Html.DisplayNameFor(m => m.ContentType)</th>
                <th>@Html.DisplayNameFor(m => m.Size)</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>@Html.DisplayFor(m => m.Id)</td>
                <td id="FileName">@Html.DisplayFor(m => m.Name)</td>
                <td>@Html.DisplayFor(m => m.ContentType)</td>
                <td>@Html.DisplayFor(m => m.Size)</td>
                <td>
                    <a href="#" class="btn btn-info btn-sm"
                       onclick="Download('@Model.Id');">Pobierz</a>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<style>
    .panel-heading {
        padding: 0px 0px 0px 5px;
    }

    .panel-body {
        padding: 5px;
    }

    .h4 {
        margin-top: 1px;
        margin-bottom: 1px;
    }
</style>

<script>
    var Download = function (id) {
        var url = "/Attachment/Download?attachmentId=" + id;
        //var fileName = $("[name='FileName']");
        var fileName = $('#FileName').text();
        console.log(fileName);
        $.ajax({
            url: url,
            cache: false,
            xhr: function () {
                var xhr = new XMLHttpRequest();
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 2) {
                        if (xhr.status == 200) {
                            xhr.responseType = "blob";
                        } else {
                            xhr.responseType = "text";
                        }
                    }
                };
                return xhr;
            },
            success: function (data) {
                //Convert the Byte Data to BLOB object.
                var blob = new Blob([data], { type: "application/octetstream" });
                var url = window.URL || window.webkitURL;
                link = url.createObjectURL(blob);
                var a = $("<a />");
                a.attr("download", fileName);
                console.log(fileName)
                a.attr("href", link);
                $("body").append(a);
                a[0].click();
                $("body").remove(a);
                var message = "Załącznik jest pobierany";
                Swal.fire({
                    title: message,
                    type: "success",
                    onAfterClose: () => {
                        location.reload();
                    }
                });
            }
        });
    };
</script>